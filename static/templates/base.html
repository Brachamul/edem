{% extends "meta.html" %}
{% load static %}

{% if page_title %}{% block title %}{{ page_title }}{% endblock title %}{% endif %}

{% block head %}{{ block.super }}

<link rel="stylesheet" href="{% get_static_prefix %}css/notifications.css" >
<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.4/jquery.min.js"></script>

{% endblock head %}


{% block header %}

<nav class="navbar" style="border-radius:0;" role="navigation">
	<div class="container-fluid">
		<div class="navbar-header">
			<button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar-collapse">
				<span class="sr-only">Toggle navigation</span>
				<span class="icon-bar"></span>
				<span class="icon-bar"></span>
				<span class="icon-bar"></span>
			</button>
			<a class="navbar-brand" href="/">
				<span class="glyphicon glyphicon-chevron-right"></span>
				<strong>Élan Démocrate</strong>
			</a>
		</div>

		<div class="collapse navbar-collapse" id="navbar-collapse">
		<ul class="nav navbar-nav navbar-right">
			<li class="dropdown">
				<a href="#" class="dropdown-toggle"
				data-toggle="dropdown" role="button" aria-expanded="false">
					{{ user.profil.nom_courant }}
				</a>
				<ul class="dropdown-menu" role="menu">
					<li><a href="{% url 'membres' %}{{ user.pk }}">
						<span class="glyphicon glyphicon-user" aria-hidden="true"></span>
						Mon profil</a>
					</li>
					<li class="divider"></li>
					<li><a href="{% url 'deconnexion' %}">
						<span class="glyphicon glyphicon-off" aria-hidden="true"></span>
						Déconnexion</a>
					</li>
				</ul>
			</li>

			<li id="notifications" class="dropdown tout-vu"> <!-- par défaut, on fait comme si pas de notifs -->
				<a id="notification-loader" href="#" class="dropdown-toggle"
				data-toggle="dropdown" role="button" aria-expanded="false">
					<span class="glyphicon glyphicon-bell" aria-hidden="true"></span>
					<span id="non-vues" class="icon-counter"><!-- JS Loaded--></span>
				</a>

				<ul id="loaded-notifications" class="dropdown-menu" role="menu">
					<!-- JS to load notifications and reload them on click-->
				</ul>


			</li>

{% comment %}
			<li class="dropdown">
				<a href="#" class="dropdown-toggle btn orange"
				data-toggle="dropdown" role="button" aria-expanded="false">
					<span class="glyphicon glyphicon-envelope" aria-hidden="true"></span>
				</a>
				<ul class="dropdown-menu" role="menu">
					<li>
						<a href="#">Messages</a>
					</li>
				</ul>
			</li>
{% endcomment %}
	
			{% if user.is_staff %}
			<li class="dropdown">
				<a href="#" class="dropdown-toggle"
				data-toggle="dropdown" role="button" aria-expanded="false">
					<span class="glyphicon glyphicon-cog" aria-hidden="true"></span>
				</a>
				<ul class="dropdown-menu" role="menu">
					<li>
						<a href="/admin/">
							<span class="glyphicon glyphicon-wrench" aria-hidden="true"></span>
							Administration</a>
					</li>
					{% if perms.fichiers_adhérents.peut_televerser %}
					<li>
						<a href="{% url 'televersement_du_fichier_adhérent' %}">
							<span class="glyphicon glyphicon-cloud-upload" aria-hidden="true"></span>
							Téléverser un fichier adhérents</a>
					</li>
					{% endif %}
					{% if perms.fichiers_adhérents.gere_les_mandats %}
					<li>
						<a href="{% url 'mandats' %}">
							<span class="glyphicon glyphicon-tags" aria-hidden="true"></span>
							Voir les mandats</a>
					</li>
					{% endif %}
					{% if user.is_superuser %}
					<li>
						<a href="{% url 'tableau_de_bord' %}">
							<span class="glyphicon glyphicon-dashboard" aria-hidden="true"></span>
							Tableau de bord</a>
					</li>
					{% endif %}
				</ul>
			</li>
			{% endif %}
		</ul>
		</div><!-- end collapse -->
	</div>
</nav>

{% endblock header %}

{% block content %}

	<!-- Main content displayed here -->

{% endblock content %}

{% block footer %}

<div class="footer-wrapper">

<p>Si vous rencontrez un bug, signalez le bugs sur <a href="https://github.com/Brachamul/elan-democrate/issues/new">GitHub</a>.  Le réseau Élan Démocrate est développé par Antonin Grêlé, des Jeunes Démocrates. Remerciements à Antoine Carette, Stéphane Manet et Stephen Daloz.</p>

<p>Pour participer à l'amélioration de cet outil, n'hésitez pas à <a href="mailto:antonin.grele@gmail.com">me contacter</a> !</p>

</div>

{% endblock footer %}

{% block scripts %} {{ block.super }}

<script src="{% get_static_prefix %}js/notifications.js"></script>

{% endblock scripts %}