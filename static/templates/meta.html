{% load static %}

<!DOCTYPE html>
<html lang="fr">

<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	{% block head %}{% endblock head %}
	<!--[if lt IE 9]>
	  <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
	  <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
	<![endif]-->
	<link rel="stylesheet" href="{% get_static_prefix %}bootstrap/css/bootstrap.min.css" >
	<link rel="stylesheet" href="{% get_static_prefix %}css/base.css" >
	<link rel="stylesheet" href="{% get_static_prefix %}css/auth.css" >
</head>

{% if not user.is_authenticated %}

	<body class="authentification-body">
	<div class="container">

	<h1 class="elan-democrate "><a href="/">Élan Démocrate</a></h1>

	{% if messages %}
		<br>
		<div class="messages">
		{% for message in messages %}
			<div{% if message.tags %} class="alert alert-{{message.tags}}"{% endif %}>{{ message }}</div>
		{% endfor %}
		</div>
	{% endif %}

	{% if logging_in %}

		<h2>Connexion</h2>
		<form
			method="POST"
			action="" role="form"
			enctype="multipart/form-data"
			>{% csrf_token %}
		
			<div class="form-group">
				<label class="control-label">Votre adresse email ou numéro d'adhérent :</label>
				<input
				id=""
				name="numero_adherent_ou_email"
				placeholder="Email ou n° adhérent"
				value="{{ username }}"
				class="form-control"
				type="text"
				autofocus=""
				>
			</div>
		
			{% if code_sent %}
			<div class="form-group">
				<label class="control-label">Votre code d'accès :</label>
				<input type="text" name="code" placeholder="Code" class="form-control">
			</div>
			{% endif %}
		
			{% if code_sent %}
			<!-- informs Django that we're going to try and log someone in -->
			<p><button type="submit" class="btn orange" name="form_type" value="login">
				<span class="glyphicon glyphicon-arrow-right" aria-hidden="true"></span>
				Connexion
			</button><p>
			{% endif %}
		
			<!-- informs Django that we're going to send an auth code -->
			<p><button type="submit" class="btn orange" name="form_type" value="send_code">
				<span class="glyphicon glyphicon-arrow-right" aria-hidden="true"></span>
				Recevoir un {% if code_sent %}nouveau{% endif %} code d'accès
			</button><p>
		
		</form>

	{% elif registering %}

		<h2>Créer un compte</h2>
		<form
			method="POST"
			action=""
			role="form"
			enctype="multipart/form-data"
			>{% csrf_token %}
			<div class="form-group">
				<label class="control-label">Veuillez indiquer votre numéro d'adhérent, ou l'adresse mail que vous avez fourni au MoDem lors de votre adhésion :</label>
				<input
				id=""
				name="numero_adherent_ou_email"
				placeholder="Email ou n° adhérent"
				value="{{ username }}"
				class="form-control"
				type="text"
				autofocus=""
				>
			</div>
			<p><button type="submit" class="btn orange"><span class="glyphicon glyphicon-pencil" aria-hidden="true"></span> S'enregistrer</button></p>
		</form>
		<input id="je-ne-suis-pas-adherent" type="checkbox" class="checkbox-hack">
		<label for="je-ne-suis-pas-adherent">Je ne suis pas / plus adhérent</label>
		<p>Seuls les adhérents jeunes du Mouvement Démocrate ont accès à cet espace. Cependant, si vous avez été adhérent par le passé, il y a moins de deux ans, il est possible que vos données soient encore accessibles, et vous pouvez vous enregistrer normalement. Pour adhérer ou réadhérer au Mouvement Démocrate, rendez-vous <a href="http://guepar.mouvementdemocrate.fr/" target="_blank">ici</a>.</p>
		<input id="je-ne-suis-pas-jeune" type="checkbox" class="checkbox-hack">
		<label for="je-ne-suis-pas-jeune">Je ne suis pas / plus jeune</label>
		<p>L'initiative Élan Démocrate étant portée par les Jeunes Démocrates, nous n'avons pas accès aux données des adhérents dits "aînés". Si vous avez plus de 32 ans, vous ne pourrez pas vous enregistrer.</p>
		<input id="je-n-y-arrive-pas" type="checkbox" class="checkbox-hack">
		<label for="je-n-y-arrive-pas">Je n'arrive pas à m'enregistrer</label>
		<p>En cas de difficultés, contactez :<br/>
			<a href="mailto:aidez-moi@elandemocrate.fr?Subject=J'ai un problème !">aidez-moi@elandemocrate.fr</a></p>
		<input id="je-veux-me-connecter" type="checkbox" class="checkbox-hack">
		<label for="je-veux-me-connecter">Je veux revenir à la page de connexion</label>
		<p style="border: none; padding: 0;"><a class="btn orange" href="{% url 'connexion' %}" style="font-weight: normal;">
			<span class="glyphicon glyphicon-arrow-right" aria-hidden="true"></span> Se connecter</a><br></p>

	{% else %}

		<form
			method="POST"
			action="{% url 'connexion' %}"
			role="form"
			enctype="multipart/form-data"
			>{% csrf_token %}
			<div>
				<input
					id="numero_adherent_ou_email"
					name="numero_adherent_ou_email"
					placeholder="Email ou n° adhérent"
					class="form-control"
					type="text"
					autofocus=""
					>
			</div>
			<input type="hidden" name="form_type" value="send_code">
			<p style="text-align: center;">
				<button type="submit" class="btn orange">
					<span class="glyphicon glyphicon-arrow-right" aria-hidden="true"></span> Se connecter</button>
			<a class="btn orange" href="{% url 'enregistrement' %}" style="font-weight: normal; margin-left: 1rem;">
					<span class="glyphicon glyphicon-pencil" aria-hidden="true"></span> Créer un compte</a></p>
		</form>
		<br>
		<input id="ou-suis-je" type="checkbox" class="checkbox-hack">
		<label for="ou-suis-je">Où suis-je ?</label>
		<p>Vous êtes sur Élan Démocrate, le réseau interne des Jeunes Démocrates. Si vous êtes adhérent du Mouvement Démocrate, et que votre adhésion a déjà été enregistrée par le mouvement, vous pouvez créer un compte. En cas de difficultés, contactez :<br/>
			<a href="mailto:aidez-moi@elandemocrate.fr?Subject=J'ai un problème !">aidez-moi@elandemocrate.fr</a></p>
	

	{% endif %}

	</div>
	</body>

{% else %}

	<body style="margin-top: 50px; padding-top: 30px;">
	
	<header>
		{% block header %}{% endblock header %}
	</header>
	
	<div class="container-fluid">
		{% block content %}{% endblock content %}
	</div>
	
	<footer>
		{% block footer %}{% endblock footer %}
	</footer>

{% endif %}

</body>

<!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
<!-- Include all compiled plugins (below), or include individual files as needed -->
<script src="{% get_static_prefix %}bootstrap/js/bootstrap.min.js"></script>

</html>